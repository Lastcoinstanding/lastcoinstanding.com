<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">

    <!-- Google Analytics (GA4) — Replace G-WNGLLPPR5M with your Measurement ID -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WNGLLPPR5M"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-WNGLLPPR5M');
    </script>
    <!-- SEO -->
    <meta name="description" content="Six existing ideas. One irreducible discovery. Explore each component that makes Bitcoin work, then try removing one to see exactly what collapses — and why this synthesis could only happen once.">
    <link rel="canonical" href="https://lastcoinstanding.com/synthesis.html">

    <!-- Open Graph / Social -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://lastcoinstanding.com/synthesis.html">
    <meta property="og:title" content="The Bitcoin Synthesis — Why Sound Money Could Only Be Discovered Once">
    <meta property="og:description" content="Six existing ideas combined into one irreducible discovery. Explore Bitcoin's components interactively, then remove one to see what collapses.">
    <meta property="og:image" content="https://lastcoinstanding.com/og-preview.jpg">
    <meta property="og:image:width" content="1280">
    <meta property="og:image:height" content="720">
    <meta property="og:image:type" content="image/jpeg">
    <meta property="og:site_name" content="Last Coin Standing">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="The Bitcoin Synthesis — Why Sound Money Could Only Be Discovered Once">
    <meta name="twitter:description" content="Six existing ideas combined into one irreducible discovery. Explore Bitcoin's components interactively, then remove one to see what collapses.">
    <meta name="twitter:image" content="https://lastcoinstanding.com/og-preview.jpg">

    <title>The Bitcoin Synthesis — Last Coin Standing</title>

    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "@id": "https://lastcoinstanding.com/synthesis.html",
      "url": "https://lastcoinstanding.com/synthesis.html",
      "name": "The Bitcoin Synthesis — Why Sound Money Could Only Be Discovered Once",
      "description": "Six existing ideas. One irreducible discovery. Explore each component that makes Bitcoin work, then try removing one to see exactly what collapses — and why this synthesis could only happen once.",
      "isPartOf": { "@id": "https://lastcoinstanding.com/#website" },
      "about": { "@type": "Thing", "name": "Bitcoin", "sameAs": "https://en.wikipedia.org/wiki/Bitcoin" },
      "publisher": { "@id": "https://lastcoinstanding.com/#organization" },
      "inLanguage": "en"
    }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Outfit:wght@300;400;500;600;700;800&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #080808;
            --bg-panel: #0f0f0f;
            --border: #1a1a1a;
            --orange: #F7931A;
            --orange-dim: rgba(247,147,26,0.15);
            --orange-glow: rgba(247,147,26,0.3);
            --red: #e74c3c;
            --red-dim: rgba(231,76,60,0.15);
            --text: #e8e0d5;
            --text-dim: #999;
            --text-bright: #f0f0f0;
            --font: 'Outfit', sans-serif;
        }
        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: var(--bg); color: var(--text); font-family: var(--font); min-height: 100vh; overflow-x: hidden; -webkit-font-smoothing: antialiased; }

        /* ═══ Site Nav ═══ */
/* ─── NAV (Inter, consistent across all pages) ─── */
.site-nav { display: flex; align-items: center; justify-content: space-between; padding: 12px 24px; background: rgba(10,9,8,0.95); border-bottom: 1px solid #1a1a1a; position: sticky; top: 0; z-index: 1000; backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
.site-nav .brand { font-family: 'Inter', -apple-system, sans-serif; font-size: 0.8rem; font-weight: 600; letter-spacing: 0.18em; text-transform: uppercase; color: #999; text-decoration: none; transition: color 0.2s; }
.site-nav .brand:hover { color: var(--orange, #F7931A); }
.site-nav .nav-links { display: flex; gap: 8px; }
.site-nav .nav-links a { font-family: 'Inter', -apple-system, sans-serif; font-size: 0.9rem; font-weight: 500; color: #aaa; text-decoration: none; padding: 8px 16px; border-radius: 4px; transition: color 0.2s, background 0.2s; }
.site-nav .nav-links a:hover { color: #ccc; background: rgba(255,255,255,0.04); }
.site-nav .nav-links a.active { color: var(--orange, #F7931A); background: rgba(247,147,26,0.08); font-weight: 600; }

/* Hamburger (hidden on desktop) */
.hamburger { display: none; background: none; border: none; cursor: pointer; padding: 4px; z-index: 1100; }
.hamburger span { display: block; width: 22px; height: 2px; background: #aaa; margin: 5px 0; border-radius: 1px; transition: transform 0.3s, opacity 0.3s, background 0.3s; }
.hamburger:hover span { background: #ccc; }
.hamburger.open span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
.hamburger.open span:nth-child(2) { opacity: 0; }
.hamburger.open span:nth-child(3) { transform: rotate(-45deg) translate(5px, -5px); }

/* Mobile nav overlay */
.mobile-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(10,9,8,0.97); z-index: 1050; flex-direction: column; align-items: center; justify-content: center; gap: 8px; opacity: 0; transition: opacity 0.3s; }
.mobile-overlay.show { display: flex; opacity: 1; }
.mobile-overlay a { font-family: 'Inter', -apple-system, sans-serif; font-size: 1.1rem; font-weight: 500; color: #aaa; text-decoration: none; padding: 14px 32px; border-radius: 6px; transition: color 0.2s, background 0.2s; }
.mobile-overlay a:hover { color: #ccc; background: rgba(255,255,255,0.04); }
.mobile-overlay a.active { color: var(--orange, #F7931A); background: rgba(247,147,26,0.08); font-weight: 600; }

@media (max-width: 768px) {
    .site-nav .nav-links { display: none; }
    .hamburger { display: block; }
}
@media (max-width: 480px) {
    .site-nav { padding: 10px 14px; }
    .site-nav .brand { font-size: 0.72rem; letter-spacing: 0.14em; }
}

        /* ═══ Page Layout ═══ */
        .page { max-width: 1140px; margin: 0 auto; padding: 48px 24px 60px; }
        header { text-align: center; margin-bottom: 48px; }
        header h1 { font-size: clamp(1.8rem, 4vw, 2.8rem); font-weight: 800; color: var(--orange); letter-spacing: -0.02em; margin-bottom: 10px; }
        header .subtitle { font-size: clamp(0.85rem, 1.6vw, 1.0rem); color: #bbb; font-weight: 400; letter-spacing: 0.01em; line-height: 1.6; max-width: 560px; margin: 0 auto; }
        header .subtitle .line1 { display: block; margin-bottom: 2px; }

        /* ═══ Main Grid ═══ */
        main { display: grid; grid-template-columns: 1fr 380px; gap: 48px; align-items: start; }
        .viz-section { display: flex; flex-direction: column; align-items: center; }

        /* ═══ SVG Visualization ═══ */
        .svg-wrap { width: 100%; max-width: 520px; position: relative; }
        #synthesis-svg { width: 100%; height: auto; display: block; }

        /* ═══ Progress Bar ═══ */
        .progress { margin-top: 24px; width: 100%; max-width: 400px; text-align: center; }
        .progress-track { width: 100%; height: 2px; background: var(--border); border-radius: 1px; overflow: hidden; }
        .progress-fill { height: 100%; width: 0%; background: var(--orange); border-radius: 1px; transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
        .progress-text { margin-top: 10px; font-size: 0.78rem; color: #aaa; font-weight: 400; letter-spacing: 0.03em; }
        .progress-text span { color: var(--orange); font-weight: 600; }
        .reset-btn { background: none; border: none; color: #aaa; font-family: var(--font); font-size: 0.72rem; cursor: pointer; margin-left: 12px; text-decoration: underline; text-underline-offset: 2px; opacity: 0; transition: opacity 0.3s ease, color 0.2s ease; pointer-events: none; }
        .reset-btn.show { opacity: 1; pointer-events: auto; }
        .reset-btn:hover { color: var(--orange); }

        /* ═══ Info Panel ═══ */
        .info-panel { padding: 32px 28px; background: var(--bg-panel); border: 1px solid var(--border); border-radius: 10px; position: sticky; top: 72px; min-height: 360px; transition: border-color 0.4s; }
        .info-panel.removal-mode { border-color: rgba(231,76,60,0.2); }
        .info-panel.complete-mode { border-color: rgba(247,147,26,0.2); }
        .panel-default { transition: opacity 0.3s ease; }
        .panel-default p { color: #bbb; line-height: 1.75; font-size: 0.95rem; font-weight: 400; }
        .panel-default p + p { margin-top: 14px; }
        .panel-default .cta { display: inline-block; margin-top: 20px; padding: 7px 16px; border: 1px solid #252525; border-radius: 5px; font-size: 0.78rem; color: var(--orange); font-weight: 500; letter-spacing: 0.02em; }

        .panel-content { display: none; animation: fadeUp 0.35s ease; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }

        .concept-tag { font-size: 0.7rem; font-weight: 500; color: #aaa; text-transform: uppercase; letter-spacing: 0.12em; margin-bottom: 8px; }
        .concept-tag.removal { color: var(--red); }
        .concept-name { font-size: 1.35rem; font-weight: 700; color: var(--orange); letter-spacing: -0.01em; margin-bottom: 16px; line-height: 1.2; }
        .concept-name.removal { color: var(--red); }
        .concept-desc { line-height: 1.75; color: var(--text); font-size: 0.92rem; font-weight: 400; }
        .concept-deeper { margin-top: 16px; }
        .deeper-toggle { background: none; border: 1px solid #333; color: #aaa; font-family: var(--font); font-size: 0.75rem; padding: 5px 14px; border-radius: 4px; cursor: pointer; transition: all 0.2s; letter-spacing: 0.02em; }
        .deeper-toggle:hover { color: var(--orange); border-color: rgba(247,147,26,0.3); }
        .deeper-content { display: none; margin-top: 14px; padding-top: 14px; border-top: 1px solid var(--border); line-height: 1.75; color: #bbb; font-size: 0.85rem; }
        .deeper-content.show { display: block; animation: fadeUp 0.3s ease; }

        .removal-verdict { margin-top: 16px; padding: 14px 16px; background: rgba(231,76,60,0.06); border: 1px solid rgba(231,76,60,0.15); border-radius: 6px; }
        .removal-verdict .verdict-label { font-size: 0.7rem; font-weight: 600; color: var(--red); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 6px; }
        .removal-verdict .verdict-text { font-size: 0.88rem; line-height: 1.65; color: var(--text); }

        .first-badge { display: inline-block; margin-top: 14px; padding: 5px 12px; background: rgba(247,147,26,0.08); border: 1px solid rgba(247,147,26,0.2); border-radius: 4px; font-size: 0.72rem; color: var(--orange); font-weight: 500; letter-spacing: 0.03em; }

        /* ═══ Completion panel ═══ */
        .completion-panel { animation: fadeUp 0.5s ease; }
        .completion-panel .complete-title { font-size: 1.2rem; font-weight: 700; color: var(--orange); margin-bottom: 14px; }
        .completion-panel .complete-desc { line-height: 1.75; color: var(--text); font-size: 0.92rem; margin-bottom: 16px; }
        .completion-panel .try-removal { padding: 12px 16px; background: rgba(231,76,60,0.06); border: 1px solid rgba(231,76,60,0.15); border-radius: 6px; font-size: 0.82rem; color: #bbb; line-height: 1.6; }
        .completion-panel .try-removal strong { color: var(--red); font-weight: 600; }

        /* ═══ Precursors Section ═══ */
        .precursors { margin-top: 80px; }
        .precursors h2 { font-size: clamp(1.3rem, 3vw, 1.8rem); font-weight: 700; color: var(--text-bright); letter-spacing: -0.02em; margin-bottom: 8px; text-align: center; }
        .precursors .section-sub { font-size: 0.88rem; color: #bbb; text-align: center; margin-bottom: 40px; line-height: 1.6; max-width: 600px; margin-left: auto; margin-right: auto; }
        .precursor-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .precursor-card { background: var(--bg-panel); border: 1px solid var(--border); border-radius: 8px; padding: 24px; transition: border-color 0.3s; }
        .precursor-card:hover { border-color: #2a2a2a; }
        .precursor-year { font-size: 0.7rem; font-weight: 500; color: var(--orange); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 6px; }
        .precursor-name { font-size: 1.1rem; font-weight: 700; color: var(--text-bright); margin-bottom: 10px; }
        .precursor-contrib { font-size: 0.85rem; color: var(--text); line-height: 1.65; margin-bottom: 12px; }
        .precursor-flaw { font-size: 0.78rem; color: #bbb; line-height: 1.6; padding-top: 10px; border-top: 1px solid var(--border); }
        .precursor-flaw strong { color: var(--red); font-weight: 600; font-size: 0.72rem; text-transform: uppercase; letter-spacing: 0.06em; }

        /* ═══ Mesh line animation ═══ */
        @keyframes meshDraw {
            from { stroke-dashoffset: 300; opacity: 0; }
            to { stroke-dashoffset: 0; opacity: 1; }
        }
        .mesh-line { stroke-dasharray: 300; stroke-dashoffset: 300; opacity: 0; }
        .mesh-line.active { animation: meshDraw 0.6s ease forwards; }

        /* ═══ Core pulse on completion ═══ */
        @keyframes corePulse {
            0% { r: 48; opacity: 0.9; }
            50% { r: 52; opacity: 1; }
            100% { r: 48; opacity: 0.9; }
        }

        /* ═══ Responsive ═══ */
        @media (max-width: 1024px) {
            main { grid-template-columns: 1fr; gap: 28px; }
            .info-panel { position: static; min-height: auto; order: 2; }
            .viz-section { order: 1; }
        }
        @media (max-width: 768px) {
            .page { padding: 32px 16px 48px; }
            header { margin-bottom: 32px; }
            .precursors { margin-top: 56px; }
            .precursor-grid { grid-template-columns: 1fr; }
        }
        @media (max-width: 600px) {
            .page { padding: 24px 14px 40px; }
            header { margin-bottom: 24px; }
            header h1 { font-size: 1.5rem; }
            header .subtitle { font-size: 0.8rem; }
            .svg-wrap { max-width: 100%; }
            .info-panel { padding: 22px 18px; border-radius: 8px; }
            .concept-name { font-size: 1.15rem; margin-bottom: 12px; }
            .concept-desc { font-size: 0.85rem; }
            .precursor-card { padding: 18px; }
        }
        @media (max-width: 480px) {
            header h1 { font-size: 1.3rem; }
            .info-panel { padding: 18px 14px; }
            .concept-name { font-size: 1.05rem; }
        }
    </style>
</head>
<body>
    <nav class="site-nav">
    <a href="/" class="brand">Last Coin Standing</a>
    <div class="nav-links">
        <a href="/synthesis.html" class="active">The Synthesis</a>
        <a href="/what-bitcoin-is.html">What Bitcoin Is</a>
        <a href="/the-bitcoin-migration.html">The Migration</a>
        <a href="/trilemma.html">The Trilemma</a>
        <a href="/the-half-life.html">The Half-Life</a>
        <a href="/money-trees.html">Money Trees</a>
        <a href="/about.html">About</a>
    </div>
    <button class="hamburger" id="hamburger" aria-label="Menu">
        <span></span><span></span><span></span>
    </button>
</nav>
<div class="mobile-overlay" id="mobileOverlay">
    <a href="/money-trees.html">The Money Trees</a>
    <a href="/what-bitcoin-is.html">What Bitcoin Is</a>
    <a href="/synthesis.html" class="active">The Synthesis</a>
    <a href="/trilemma.html">The Trilemma</a>
    <a href="/the-half-life.html">The Half-Life</a>
    <a href="/about.html">About</a>
</div>

    <div class="page">
        <header>
            <h1>The Bitcoin Synthesis</h1>
            <p class="subtitle">
                <span class="line1">Six existing ideas. One irreducible discovery.</span>
                Why sound money could only be discovered once.
            </p>
        </header>

        <main>
            <div class="viz-section">
                <div class="svg-wrap">
                    <svg id="synthesis-svg" viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <filter id="glow">
                                <feGaussianBlur stdDeviation="4" result="blur"/>
                                <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
                            </filter>
                            <filter id="glow-soft">
                                <feGaussianBlur stdDeviation="2.5" result="blur"/>
                                <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
                            </filter>
                            <radialGradient id="coreGrad" cx="50%" cy="50%" r="50%">
                                <stop offset="0%" stop-color="rgba(247,147,26,0.10)"/>
                                <stop offset="100%" stop-color="rgba(247,147,26,0)"/>
                            </radialGradient>
                            <radialGradient id="coreGradActive" cx="50%" cy="50%" r="50%">
                                <stop offset="0%" stop-color="rgba(247,147,26,0.18)"/>
                                <stop offset="100%" stop-color="rgba(247,147,26,0)"/>
                            </radialGradient>
                        </defs>

                        <!-- Ambient glow behind core -->
                        <circle id="core-ambient" cx="250" cy="250" r="80" fill="url(#coreGrad)" opacity="0.5"/>

                        <!-- Mesh connections (hidden until completion) -->
                        <g id="mesh-lines"></g>

                        <!-- Radial connection lines (orb to center) -->
                        <g id="radial-lines"></g>

                        <!-- Component orbs -->
                        <g id="component-orbs"></g>

                        <!-- Central Bitcoin core -->
                        <g id="core-group">
                            <circle id="core-ring" cx="250" cy="250" r="48" fill="none" stroke="#333" stroke-width="2" opacity="0.6"/>
                            <circle id="core-fill" cx="250" cy="250" r="48" fill="rgba(15,15,15,0.8)"/>
                            <text id="core-text-btc" x="250" y="244" text-anchor="middle" fill="#555" font-family="'Outfit', sans-serif" font-size="13" font-weight="700" letter-spacing="0.08em">BITCOIN</text>
                            <text id="core-text-sym" x="250" y="262" text-anchor="middle" fill="#444" font-family="'Outfit', sans-serif" font-size="9" font-weight="400" letter-spacing="0.06em">&#x20BF;</text>
                        </g>
                    </svg>
                </div>

                <!-- Progress bar -->
                <div class="progress">
                    <div class="progress-track">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <p class="progress-text">
                        <span id="progressCount">0</span> of 6 components explored
                        <button class="reset-btn" id="resetBtn" onclick="resetAll()">reset</button>
                    </p>
                </div>
            </div>

            <div class="info-panel" id="infoPanel">
                <div class="panel-default" id="panelDefault">
                    <p>Bitcoin is not a single invention &#8212; it is an irreducible synthesis of six existing ideas, none of which could work alone.</p>
                    <p>Each component is necessary. Remove any one, and the system doesn&#8217;t merely weaken &#8212; it becomes fundamentally untenable.</p>
                    <p class="cta">&#8592; Click each component to explore</p>
                </div>
                <div class="panel-content" id="panelContent"></div>
            </div>
        </main>

        <!-- Precursors Section -->
        <section class="precursors">
            <h2>The Shoulders It Stands On</h2>
            <p class="section-sub">Bitcoin was not the first attempt at digital money. Each predecessor contributed a critical piece &#8212; and each fell short for a specific, instructive reason.</p>
            <div class="precursor-grid" id="precursorGrid"></div>
        </section>
    </div>

<script>
/* ═══════════════════════════════════════════════
   DATA
   ═══════════════════════════════════════════════ */
var components = [
    {
        id: 'pow',
        name: 'Proof of Work',
        shortName: 'Proof of\nWork',
        tagline: 'Component 1 of 6',
        desc: 'Converts energy into security. Miners compete to solve a cryptographic puzzle, expending measurable, unforgeable work. This makes it prohibitively expensive to attack the network \u2014 the cost of subversion must exceed the cost of honest participation.',
        deeper: 'Rooted in Adam Back\u2019s Hashcash (1997), Bitcoin\u2019s PoW uses two rounds of SHA-256 hashing. Miners search for a nonce that produces a hash below the network\u2019s target. The process is computationally intensive to perform but trivial to verify \u2014 asymmetry that underpins the entire security model.',
        removal: 'Without Proof of Work, there is no cost to proposing blocks. Any actor can flood the network with conflicting histories at zero expense. The entire security model \u2014 which depends on it being more expensive to attack than to participate honestly \u2014 collapses. You get a database, not a decentralized monetary system.',
        verdictLabel: 'System collapses',
        firstBadge: null
    },
    {
        id: 'difficulty',
        name: 'Difficulty Adjustment',
        shortName: 'Difficulty\nAdjust',
        tagline: 'Component 2 of 6',
        desc: 'The network\u2019s metabolism. Every 2,016 blocks (~2 weeks), the protocol recalibrates the mining puzzle difficulty based on total hashrate. More miners join? The puzzle gets harder. Miners leave? It gets easier. This maintains the 10-minute average block time regardless of hardware advances.',
        deeper: 'The 10-minute block interval is a deliberate engineering choice: long enough for blocks to propagate globally so nodes can converge on one truth, short enough to remain practical. Without this adjustment, Moore\u2019s Law and ASIC development would have accelerated block production to the point where all 21 million bitcoin would have been mined within the first few years.',
        removal: 'Without Difficulty Adjustment, the issuance schedule breaks immediately. As mining hardware improves, blocks are found faster and faster. The fixed 21 million supply gets exhausted in years instead of decades. Worse, the 10-minute propagation window \u2014 which gives global nodes time to converge \u2014 shrinks until the network can no longer maintain consensus.',
        verdictLabel: 'Issuance schedule breaks',
        firstBadge: null
    },
    {
        id: 'blockchain',
        name: 'Blockchain',
        shortName: 'Block-\nchain',
        tagline: 'Component 3 of 6',
        desc: 'The immutable chronological record. Each block contains the hash of the previous block, forming a cumulative chain. To alter any past transaction, an attacker would need to re-mine every subsequent block \u2014 a cost that grows exponentially with each confirmation.',
        deeper: 'The chaining mechanism uses SHA-256 hashes to link blocks in sequence. Combined with the P2P network, every node maintains an identical copy of this ledger. The Genesis Block, mined January 3, 2009, embedded The Times headline \u201CChancellor on brink of second bailout for banks\u201D \u2014 both a proof of existence and a statement of intent.',
        removal: 'Without the blockchain\u2019s chaining mechanism, there is no chronological ordering and no cumulative security. Transactions exist in isolation with no way to determine which came first. The double-spend problem \u2014 the fundamental challenge of digital money \u2014 returns in full force. You have digital tokens with no reliable history.',
        verdictLabel: 'Double-spend returns',
        firstBadge: 'First solution to the double-spend problem without a trusted third party'
    },
    {
        id: 'crypto',
        name: 'Public-Key Cryptography',
        shortName: 'Public-Key\nCrypto',
        tagline: 'Component 4 of 6',
        desc: 'Self-sovereign ownership through mathematics. A private key generates a public key via a one-way function (the secp256k1 elliptic curve). Digital signatures prove ownership without revealing the key itself. No identity documents. No intermediaries. Possession of the key is the only valid proof.',
        deeper: 'Bitcoin uses ECDSA (with Schnorr signatures added via Taproot) for transaction authorization. The mathematical relationship is strictly one-way: deriving a private key from its public key is computationally infeasible. This creates true self-sovereignty \u2014 but also means losing a private key results in permanent, irrecoverable loss. There is no \u201Cforgot password\u201D in a trustless system.',
        removal: 'Without public-key cryptography, there is no way to prove ownership of funds without a central authority. Anyone could claim anyone else\u2019s bitcoin. The system would require identity verification, access controls, and trusted administrators \u2014 recreating exactly the intermediary-dependent architecture Bitcoin was designed to eliminate.',
        verdictLabel: 'Ownership becomes meaningless',
        firstBadge: null
    },
    {
        id: 'incentive',
        name: 'Incentive Structure',
        shortName: 'Incentive\nStructure',
        tagline: 'Component 5 of 6',
        desc: 'Aligns self-interest with network security. Miners receive block rewards (new bitcoin) and transaction fees for honest work. The halving \u2014 cutting rewards 50% every 210,000 blocks (~4 years) \u2014 creates a predictable, diminishing inflation rate that asymptotically approaches the 21 million hard cap.',
        deeper: 'This is Bitcoin\u2019s economic engine. The incentive design means that the most profitable strategy for any rational actor is to play by the rules. A 51% attack, while theoretically possible, would require such massive capital expenditure that the attacker would earn more by mining honestly. Game theory enforces what no regulator could.',
        removal: 'Without the incentive structure, no rational actor expends energy to secure the network. Mining becomes charity work. The hashrate drops to zero, and with it, all security guarantees. Meanwhile, with no fixed supply schedule, the monetary properties that make bitcoin valuable as a store of value \u2014 the entire economic thesis \u2014 disappear.',
        verdictLabel: 'No one secures the network',
        firstBadge: 'First provably finite digital asset \u2014 absolute digital scarcity'
    },
    {
        id: 'p2p',
        name: 'Peer-to-Peer Network',
        shortName: 'P2P\nNetwork',
        tagline: 'Component 6 of 6',
        desc: 'Eliminates single points of failure. Every node maintains an identical copy of the ledger and independently validates every transaction. Consensus emerges from the network following the chain with the most accumulated work \u2014 no leader, no central server, no authority to corrupt or coerce.',
        deeper: 'This is the component that eluded every predecessor. DigiCash required banks. RPOW required a central server. B-money and Bit Gold couldn\u2019t solve coordination without a leader. The P2P topology means there is no company to subpoena, no server to shut down, no CEO to arrest. The network persists as long as any nodes are running.',
        removal: 'Without peer-to-peer distribution, Bitcoin requires a central server. That server becomes a single point of failure \u2014 it can be shut down by governments, attacked by hackers, or corrupted by its operators. This is precisely why every digital cash attempt before Bitcoin failed. Centralization was the fatal flaw each time.',
        verdictLabel: 'Single point of failure returns',
        firstBadge: 'First trust-minimized peer-to-peer value transfer'
    }
];

var precursors = [
    { name: 'eCash (DigiCash)', year: '1989', creator: 'David Chaum',
      contribution: 'Introduced \u201Cblind signatures\u201D \u2014 cryptographic techniques enabling private digital token transfers. First real implementation of anonymous digital cash.',
      flaw: 'Centralized. Required bank participation to operate. When DigiCash went bankrupt in 1998, the entire system died with it.' },
    { name: 'Hashcash', year: '1997', creator: 'Adam Back',
      contribution: 'Developed the Proof-of-Work concept \u2014 requiring computational effort to send messages, originally to combat email spam. This became the direct foundation for Bitcoin\u2019s mining mechanism.',
      flaw: 'No ledger, no double-spend protection. Hashcash tokens were single-use stamps, not a functional currency. There was no way to track or transfer value.' },
    { name: 'B-money', year: '1998', creator: 'Wei Dai',
      contribution: 'First proposal for an anonymous, distributed electronic cash system where money creation required computational work. Outlined the blueprint Satoshi would later cite.',
      flaw: 'Theoretical only. Remained a whitepaper \u2014 it lacked a viable consensus mechanism and was never implemented.' },
    { name: 'Bit Gold', year: '1998', creator: 'Nick Szabo',
      contribution: 'Envisioned \u201Cunforgeably costly bits\u201D created through Proof of Work \u2014 digital objects whose creation cost was provable, mimicking precious metals.',
      flaw: 'Sybil-vulnerable. Without a decentralized consensus mechanism, attackers could create fake nodes to subvert the property registry. Never fully implemented.' },
    { name: 'RPOW', year: '2004', creator: 'Hal Finney',
      contribution: 'First working implementation of reusable Proof-of-Work tokens as currency. Tokens could be passed from person to person \u2014 the closest anyone had come to Bitcoin.',
      flaw: 'Centralized mint. Despite its innovation, RPOW relied on a single trusted server to validate token reuse \u2014 the exact single point of failure Bitcoin would eliminate.' }
];

/* ═══════════════════════════════════════════════
   STATE
   ═══════════════════════════════════════════════ */
var CX = 250, CY = 250, RING_R = 155, ORB_R = 38, CORE_R = 48;
var explored = {};
var activeId = null;
var isComplete = false;
var isRemovalMode = false;
var removedId = null;

function getOrbPos(i) {
    var angle = (Math.PI * 2 * i / 6) - Math.PI / 2;
    return { x: CX + RING_R * Math.cos(angle), y: CY + RING_R * Math.sin(angle) };
}

/* Edge-to-edge line endpoints: point on circumference of circle A facing circle B */
function edgePoint(ax, ay, ar, bx, by) {
    var dx = bx - ax, dy = by - ay;
    var dist = Math.sqrt(dx * dx + dy * dy);
    return { x: ax + (dx / dist) * ar, y: ay + (dy / dist) * ar };
}

function svgEl(tag, attrs) {
    var el = document.createElementNS('http://www.w3.org/2000/svg', tag);
    for (var k in attrs) {
        if (attrs.hasOwnProperty(k)) el.setAttribute(k, attrs[k]);
    }
    return el;
}

function findComp(id) {
    for (var i = 0; i < components.length; i++) {
        if (components[i].id === id) return components[i];
    }
    return null;
}

function exploredCount() {
    var n = 0;
    for (var k in explored) { if (explored[k]) n++; }
    return n;
}

/* ═══════════════════════════════════════════════
   BUILD SVG
   ═══════════════════════════════════════════════ */
function buildSVG() {
    var radialG = document.getElementById('radial-lines');
    var meshG = document.getElementById('mesh-lines');
    var orbsG = document.getElementById('component-orbs');
    radialG.innerHTML = '';
    meshG.innerHTML = '';
    orbsG.innerHTML = '';

    /* Radial lines (orb edge to core edge) */
    for (var i = 0; i < 6; i++) {
        var comp = components[i];
        var pos = getOrbPos(i);
        var fromEdge = edgePoint(pos.x, pos.y, ORB_R, CX, CY);
        var toEdge = edgePoint(CX, CY, CORE_R, pos.x, pos.y);

        var line = svgEl('line', {
            x1: fromEdge.x, y1: fromEdge.y, x2: toEdge.x, y2: toEdge.y,
            stroke: '#222', 'stroke-width': '1', 'stroke-dasharray': '4 4',
            id: 'radial-' + comp.id, opacity: '0.6'
        });
        line.style.transition = 'stroke 0.5s, opacity 0.5s, stroke-dasharray 0.5s, stroke-width 0.5s';
        radialG.appendChild(line);
    }

    /* Mesh lines (every pair, edge-to-edge, hidden initially) */
    for (var a = 0; a < 6; a++) {
        for (var b = a + 1; b < 6; b++) {
            var posA = getOrbPos(a);
            var posB = getOrbPos(b);
            var eA = edgePoint(posA.x, posA.y, ORB_R, posB.x, posB.y);
            var eB = edgePoint(posB.x, posB.y, ORB_R, posA.x, posA.y);

            var mline = svgEl('line', {
                x1: eA.x, y1: eA.y, x2: eB.x, y2: eB.y,
                stroke: 'rgba(247,147,26,0.35)', 'stroke-width': '1',
                id: 'mesh-' + components[a].id + '-' + components[b].id,
                'class': 'mesh-line', opacity: '0'
            });
            meshG.appendChild(mline);
        }
    }

    /* Component orbs */
    for (var i = 0; i < 6; i++) {
        var comp = components[i];
        var pos = getOrbPos(i);

        var g = svgEl('g', { id: 'orb-' + comp.id });
        g.style.cursor = 'pointer';
        g.style.transition = 'opacity 0.4s';

        var circle = svgEl('circle', {
            cx: pos.x, cy: pos.y, r: ORB_R,
            fill: 'rgba(15,15,15,0.9)', stroke: '#333', 'stroke-width': '1.5',
            id: 'circle-' + comp.id
        });
        circle.style.transition = 'stroke 0.4s, fill 0.4s, stroke-width 0.3s';
        g.appendChild(circle);

        var textLines = comp.shortName.split('\n');
        for (var li = 0; li < textLines.length; li++) {
            var txt = svgEl('text', {
                x: pos.x,
                y: pos.y + (li - (textLines.length - 1) / 2) * 13,
                'text-anchor': 'middle', 'dominant-baseline': 'central',
                fill: '#999', 'font-family': "'Outfit', sans-serif",
                'font-size': '10.5', 'font-weight': '600',
                'letter-spacing': '0.03em', 'class': 'orb-label',
                id: 'label-' + comp.id + '-' + li
            });
            txt.style.transition = 'fill 0.4s';
            txt.style.pointerEvents = 'none';
            txt.textContent = textLines[li];
            g.appendChild(txt);
        }

        var hit = svgEl('circle', {
            cx: pos.x, cy: pos.y, r: ORB_R + 8,
            fill: 'transparent', 'data-id': comp.id
        });
        hit.addEventListener('click', onOrbClick);
        hit.addEventListener('mouseenter', onOrbEnter);
        hit.addEventListener('mouseleave', onOrbLeave);
        g.appendChild(hit);

        orbsG.appendChild(g);
    }
}

/* ═══════════════════════════════════════════════
   INTERACTION
   ═══════════════════════════════════════════════ */
function onOrbClick(e) {
    var id = e.target.getAttribute('data-id');

    if (isRemovalMode) {
        handleRemoval(id);
        return;
    }

    // Mark as explored
    explored[id] = true;
    activeId = id;

    // Highlight this orb (persistent)
    styleExploredOrb(id, true);

    // Re-style all previously explored orbs (non-active get dimmer highlight)
    for (var k in explored) {
        if (explored[k] && k !== id) {
            styleExploredOrb(k, false);
        }
    }

    // Update progress
    updateProgress();

    // Show panel
    var comp = findComp(id);
    showExplorePanel(comp);

    // Check completion
    if (exploredCount() === 6 && !isComplete) {
        triggerCompletion();
    }
}

function onOrbEnter(e) {
    var id = e.target.getAttribute('data-id');
    if (explored[id] || removedId === id) return;
    var circle = document.getElementById('circle-' + id);
    circle.setAttribute('stroke', '#555');
    circle.setAttribute('stroke-width', '2');
}

function onOrbLeave(e) {
    var id = e.target.getAttribute('data-id');
    if (explored[id] || removedId === id) return;
    var circle = document.getElementById('circle-' + id);
    circle.setAttribute('stroke', '#333');
    circle.setAttribute('stroke-width', '1.5');
}

function styleExploredOrb(id, isActive) {
    var circle = document.getElementById('circle-' + id);
    var labels = document.querySelectorAll('#orb-' + id + ' .orb-label');
    var radial = document.getElementById('radial-' + id);

    if (isActive) {
        circle.setAttribute('stroke', '#F7931A');
        circle.setAttribute('stroke-width', '2.5');
        circle.setAttribute('fill', 'rgba(247,147,26,0.06)');
        circle.style.filter = 'url(#glow)';
        for (var i = 0; i < labels.length; i++) labels[i].setAttribute('fill', '#F7931A');
        radial.setAttribute('stroke', 'rgba(247,147,26,0.5)');
        radial.setAttribute('stroke-dasharray', 'none');
        radial.setAttribute('opacity', '1');
        radial.setAttribute('stroke-width', '1.5');
    } else {
        // Previously explored: softer persistent highlight
        circle.setAttribute('stroke', 'rgba(247,147,26,0.6)');
        circle.setAttribute('stroke-width', '1.8');
        circle.setAttribute('fill', 'rgba(247,147,26,0.03)');
        circle.style.filter = 'none';
        for (var i = 0; i < labels.length; i++) labels[i].setAttribute('fill', 'rgba(247,147,26,0.7)');
        radial.setAttribute('stroke', 'rgba(247,147,26,0.3)');
        radial.setAttribute('stroke-dasharray', 'none');
        radial.setAttribute('opacity', '0.8');
        radial.setAttribute('stroke-width', '1');
    }
}

function updateProgress() {
    var count = exploredCount();
    document.getElementById('progressFill').style.width = (count / 6 * 100) + '%';
    document.getElementById('progressCount').textContent = count;
    var resetBtn = document.getElementById('resetBtn');
    if (count > 0) {
        resetBtn.classList.add('show');
    } else {
        resetBtn.classList.remove('show');
    }
}

/* ═══════════════════════════════════════════════
   COMPLETION: Mesh lights up
   ═══════════════════════════════════════════════ */
function triggerCompletion() {
    isComplete = true;

    // Activate all mesh lines with staggered animation
    var meshLines = document.querySelectorAll('.mesh-line');
    for (var i = 0; i < meshLines.length; i++) {
        (function(line, delay) {
            setTimeout(function() {
                line.style.animationDelay = '0s';
                line.classList.add('active');
            }, delay);
        })(meshLines[i], i * 60);
    }

    // Light up core after mesh draws
    setTimeout(function() {
        activateCore();
        showCompletionPanel();
        isRemovalMode = true;
    }, meshLines.length * 60 + 400);

    // Make all explored orbs fully bright
    for (var i = 0; i < components.length; i++) {
        styleExploredOrb(components[i].id, true);
        // Remove the extra-bright "active" glow, keep all equal
        var circle = document.getElementById('circle-' + components[i].id);
        circle.style.filter = 'url(#glow-soft)';
    }
}

function activateCore() {
    var ring = document.getElementById('core-ring');
    var fill = document.getElementById('core-fill');
    var txtBtc = document.getElementById('core-text-btc');
    var txtSym = document.getElementById('core-text-sym');
    var ambient = document.getElementById('core-ambient');

    ring.setAttribute('stroke', '#F7931A');
    ring.setAttribute('stroke-width', '2.5');
    ring.setAttribute('opacity', '1');
    ring.style.filter = 'url(#glow)';
    ring.style.transition = 'all 0.6s ease';

    fill.setAttribute('fill', 'rgba(247,147,26,0.06)');
    fill.style.transition = 'fill 0.6s ease';

    txtBtc.setAttribute('fill', '#F7931A');
    txtBtc.style.transition = 'fill 0.6s ease';

    txtSym.setAttribute('fill', 'rgba(247,147,26,0.7)');
    txtSym.style.transition = 'fill 0.6s ease';

    ambient.setAttribute('fill', 'url(#coreGradActive)');
    ambient.setAttribute('opacity', '0.8');
    ambient.style.transition = 'opacity 0.6s ease';
}

function deactivateCore() {
    var ring = document.getElementById('core-ring');
    var fill = document.getElementById('core-fill');
    var txtBtc = document.getElementById('core-text-btc');
    var txtSym = document.getElementById('core-text-sym');
    var ambient = document.getElementById('core-ambient');

    ring.setAttribute('stroke', '#333');
    ring.setAttribute('stroke-width', '2');
    ring.setAttribute('opacity', '0.6');
    ring.style.filter = 'none';

    fill.setAttribute('fill', 'rgba(15,15,15,0.8)');
    txtBtc.setAttribute('fill', '#555');
    txtSym.setAttribute('fill', '#444');
    ambient.setAttribute('fill', 'url(#coreGrad)');
    ambient.setAttribute('opacity', '0.5');
}

/* ═══════════════════════════════════════════════
   REMOVAL MODE (post-completion)
   ═══════════════════════════════════════════════ */
function handleRemoval(id) {
    if (removedId === id) {
        // Restore (clicking the same removed component toggles it back)
        restoreFromRemoval();
        showCompletionPanel();
        return;
    }

    // If another component is already removed, restore it first
    // This ensures only one component is removed at a time,
    // reinforcing that ANY single removal breaks the system
    if (removedId !== null) {
        restoreFromRemoval();
    }

    // Remove a component
    removedId = id;
    var comp = findComp(id);

    // Dim the removed orb
    var circle = document.getElementById('circle-' + id);
    circle.setAttribute('stroke', '#e74c3c');
    circle.setAttribute('stroke-width', '2');
    circle.setAttribute('stroke-dasharray', '6 4');
    circle.setAttribute('fill', 'rgba(231,76,60,0.04)');
    circle.style.filter = 'none';
    document.getElementById('orb-' + id).style.opacity = '0.5';

    var labels = document.querySelectorAll('#orb-' + id + ' .orb-label');
    for (var i = 0; i < labels.length; i++) labels[i].setAttribute('fill', 'rgba(231,76,60,0.5)');

    // Dim radial line
    var radial = document.getElementById('radial-' + id);
    radial.setAttribute('stroke', 'rgba(231,76,60,0.3)');
    radial.setAttribute('stroke-dasharray', '3 6');
    radial.setAttribute('opacity', '0.4');

    // Dim mesh lines involving this component
    for (var j = 0; j < components.length; j++) {
        if (components[j].id === id) continue;
        var meshId1 = 'mesh-' + id + '-' + components[j].id;
        var meshId2 = 'mesh-' + components[j].id + '-' + id;
        var mel = document.getElementById(meshId1) || document.getElementById(meshId2);
        if (mel) {
            mel.setAttribute('stroke', 'rgba(231,76,60,0.15)');
            mel.setAttribute('stroke-dasharray', '3 6');
            mel.style.opacity = '0.3';
        }
    }

    // Deactivate core (circuit broken)
    deactivateCore();

    // Dim the other orbs slightly to show system weakened
    for (var k = 0; k < components.length; k++) {
        if (components[k].id === id) continue;
        var otherCircle = document.getElementById('circle-' + components[k].id);
        otherCircle.setAttribute('stroke', 'rgba(247,147,26,0.35)');
        otherCircle.setAttribute('fill', 'rgba(247,147,26,0.02)');
        otherCircle.style.filter = 'none';
    }

    showRemovalPanel(comp);
}

function restoreFromRemoval() {
    removedId = null;

    // Restore all orbs to completed state
    for (var i = 0; i < components.length; i++) {
        var c = components[i];
        var circle = document.getElementById('circle-' + c.id);
        circle.setAttribute('stroke', 'rgba(247,147,26,0.8)');
        circle.setAttribute('stroke-width', '2');
        circle.setAttribute('stroke-dasharray', 'none');
        circle.setAttribute('fill', 'rgba(247,147,26,0.04)');
        circle.style.filter = 'url(#glow-soft)';
        document.getElementById('orb-' + c.id).style.opacity = '1';

        var labels = document.querySelectorAll('#orb-' + c.id + ' .orb-label');
        for (var j = 0; j < labels.length; j++) labels[j].setAttribute('fill', 'rgba(247,147,26,0.8)');

        var radial = document.getElementById('radial-' + c.id);
        radial.setAttribute('stroke', 'rgba(247,147,26,0.4)');
        radial.setAttribute('stroke-dasharray', 'none');
        radial.setAttribute('opacity', '0.9');
        radial.setAttribute('stroke-width', '1.2');
    }

    // Restore mesh lines
    var meshLines = document.querySelectorAll('.mesh-line');
    for (var m = 0; m < meshLines.length; m++) {
        meshLines[m].setAttribute('stroke', 'rgba(247,147,26,0.35)');
        meshLines[m].setAttribute('stroke-dasharray', 'none');
        meshLines[m].style.opacity = '1';
    }

    // Re-activate core
    activateCore();
}

/* ═══════════════════════════════════════════════
   PANELS
   ═══════════════════════════════════════════════ */
function showExplorePanel(comp) {
    var panel = document.getElementById('infoPanel');
    var defaultEl = document.getElementById('panelDefault');
    var contentEl = document.getElementById('panelContent');

    panel.classList.remove('removal-mode', 'complete-mode');
    defaultEl.style.display = 'none';
    contentEl.style.display = 'block';

    var html = '';
    html += '<div class="concept-tag">' + comp.tagline + '</div>';
    html += '<div class="concept-name">' + comp.name + '</div>';
    html += '<div class="concept-desc">' + comp.desc + '</div>';
    if (comp.firstBadge) {
        html += '<div class="first-badge">\u26A1 ' + comp.firstBadge + '</div>';
    }
    html += '<div class="concept-deeper">';
    html += '<button class="deeper-toggle" onclick="toggleDeeper(this)">Go deeper \u2192</button>';
    html += '<div class="deeper-content">' + comp.deeper + '</div>';
    html += '</div>';

    contentEl.innerHTML = html;
    animatePanel(contentEl);
}

function showCompletionPanel() {
    var panel = document.getElementById('infoPanel');
    var defaultEl = document.getElementById('panelDefault');
    var contentEl = document.getElementById('panelContent');

    panel.classList.remove('removal-mode');
    panel.classList.add('complete-mode');
    defaultEl.style.display = 'none';
    contentEl.style.display = 'block';

    var html = '<div class="completion-panel">';
    html += '<div class="complete-title">The Circuit Is Complete</div>';
    html += '<div class="complete-desc">Six components, each borrowed from decades of prior work, synthesized into something none could achieve alone. The mesh you see represents total interdependence \u2014 every component relies on every other. This is not a system with redundancy. It is irreducible.</div>';
    html += '<div style="margin-bottom:16px; font-size:0.85rem; line-height:1.65; color:#bbb;">As Adam Back (inventor of Hashcash, cited in the Bitcoin whitepaper) explains: any deviation from this design necessarily introduces a compromise greater than the supposed benefit. The parameters aren\u2019t arbitrary \u2014 they\u2019re in equilibrium. <a href="https://x.com/LastCoinStandng/status/1714789695622955431" target="_blank" rel="noopener" style="color:#F7931A; text-decoration:underline; text-underline-offset:2px;">Watch the 2-minute summary \u2192</a></div>';
    html += '<div class="try-removal"><strong>Now try removing one.</strong> Click any component to break the circuit and see exactly what collapses \u2014 and why nothing less than the full synthesis could work.</div>';
    html += '</div>';

    contentEl.innerHTML = html;
    animatePanel(contentEl);
}

function showRemovalPanel(comp) {
    var panel = document.getElementById('infoPanel');
    var defaultEl = document.getElementById('panelDefault');
    var contentEl = document.getElementById('panelContent');

    panel.classList.add('removal-mode');
    panel.classList.remove('complete-mode');
    defaultEl.style.display = 'none';
    contentEl.style.display = 'block';

    var html = '';
    html += '<div class="concept-tag removal">Without this component</div>';
    html += '<div class="concept-name removal">' + comp.name + ' Removed</div>';
    html += '<div class="concept-desc">' + comp.removal + '</div>';
    html += '<div class="removal-verdict">';
    html += '<div class="verdict-label">\u26A0 ' + comp.verdictLabel + '</div>';
    html += '<div class="verdict-text">The system becomes fundamentally untenable. This is not a degradation \u2014 it is a collapse of the core guarantee.</div>';
    html += '</div>';

    contentEl.innerHTML = html;
    animatePanel(contentEl);
}

function showDefaultPanel() {
    var panel = document.getElementById('infoPanel');
    var defaultEl = document.getElementById('panelDefault');
    var contentEl = document.getElementById('panelContent');
    panel.classList.remove('removal-mode', 'complete-mode');
    defaultEl.style.display = 'block';
    contentEl.style.display = 'none';
}

function animatePanel(el) {
    el.style.animation = 'none';
    void el.offsetHeight;
    el.style.animation = 'fadeUp 0.35s ease';
}

function toggleDeeper(btn) {
    var content = btn.nextElementSibling;
    if (content.classList.contains('show')) {
        content.classList.remove('show');
        btn.textContent = 'Go deeper \u2192';
    } else {
        content.classList.add('show');
        btn.textContent = '\u2190 Less detail';
    }
}

/* ═══════════════════════════════════════════════
   RESET
   ═══════════════════════════════════════════════ */
function resetAll() {
    explored = {};
    activeId = null;
    isComplete = false;
    isRemovalMode = false;
    removedId = null;

    // Reset all orbs
    for (var i = 0; i < components.length; i++) {
        var c = components[i];
        var circle = document.getElementById('circle-' + c.id);
        circle.setAttribute('stroke', '#333');
        circle.setAttribute('stroke-width', '1.5');
        circle.setAttribute('fill', 'rgba(15,15,15,0.9)');
        circle.setAttribute('stroke-dasharray', 'none');
        circle.style.filter = 'none';
        document.getElementById('orb-' + c.id).style.opacity = '1';

        var labels = document.querySelectorAll('#orb-' + c.id + ' .orb-label');
        for (var j = 0; j < labels.length; j++) labels[j].setAttribute('fill', '#999');

        var radial = document.getElementById('radial-' + c.id);
        radial.setAttribute('stroke', '#222');
        radial.setAttribute('stroke-width', '1');
        radial.setAttribute('stroke-dasharray', '4 4');
        radial.setAttribute('opacity', '0.6');
    }

    // Reset mesh lines - clone and replace to fully reset animation state
    var meshLines = document.querySelectorAll('.mesh-line');
    for (var m = 0; m < meshLines.length; m++) {
        var ml = meshLines[m];
        ml.classList.remove('active');
        ml.style.animation = 'none';
        ml.style.opacity = '0';
        ml.setAttribute('stroke', 'rgba(247,147,26,0.35)');
        ml.setAttribute('stroke-width', '1');
        ml.setAttribute('stroke-dasharray', '300');
        ml.setAttribute('stroke-dashoffset', '300');
        // Force reflow to reset animation state
        void ml.offsetWidth;
        ml.style.animation = '';
    }

    // Reset core
    deactivateCore();

    // Reset progress
    updateProgress();
    showDefaultPanel();
}

/* ═══════════════════════════════════════════════
   PRECURSORS
   ═══════════════════════════════════════════════ */
function buildPrecursors() {
    var grid = document.getElementById('precursorGrid');
    var html = '';
    for (var i = 0; i < precursors.length; i++) {
        var p = precursors[i];
        html += '<div class="precursor-card">';
        html += '<div class="precursor-year">' + p.year + ' \u00B7 ' + p.creator + '</div>';
        html += '<div class="precursor-name">' + p.name + '</div>';
        html += '<div class="precursor-contrib">' + p.contribution + '</div>';
        html += '<div class="precursor-flaw"><strong>Fatal flaw: </strong>' + p.flaw + '</div>';
        html += '</div>';
    }
    grid.innerHTML = html;
}

/* ═══════════════════════════════════════════════
   INIT
   ═══════════════════════════════════════════════ */
buildSVG();
buildPrecursors();
</script>
<script>
(function() {
    var hamburger = document.getElementById('hamburger');
    var overlay = document.getElementById('mobileOverlay');
    if (!hamburger || !overlay) return;
    hamburger.addEventListener('click', function() {
        hamburger.classList.toggle('open');
        overlay.classList.toggle('show');
        document.body.style.overflow = overlay.classList.contains('show') ? 'hidden' : '';
    });
    var links = overlay.querySelectorAll('a');
    for (var i = 0; i < links.length; i++) {
        links[i].addEventListener('click', function() {
            hamburger.classList.remove('open');
            overlay.classList.remove('show');
            document.body.style.overflow = '';
        });
    }
})();
</script>
</body>
</html>
