<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Fixed Pie — Last Coin Standing</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg-deep: #0a0b0f;
    --bg-card: #12131a;
    --bg-card-hover: #1a1b25;
    --btc-warm: #f7931a;
    --btc-glow: #f7931a50;
    --btc-soft: #f7931a18;
    --fiat-cold: #5a8a9e;
    --fiat-dim: #5a8a9e30;
    --fiat-soft: #5a8a9e12;
    --fiat-red: #c0392b;
    --fiat-red-soft: rgba(192,57,43,0.1);
    --text-primary: #e8e6e1;
    --text-secondary: #8a8880;
    --text-dim: #55534e;
    --border: #1e1f2a;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg-deep);
    color: var(--text-primary);
    font-family: 'DM Sans', sans-serif;
    font-weight: 300;
    min-height: 100vh;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 1000;
  }

  .container {
    max-width: 1100px;
    margin: 0 auto;
    padding: 2rem 1.5rem 4rem;
  }

  header {
    text-align: center;
    padding: 3rem 0 1.5rem;
  }

  header .label {
    font-size: 0.68rem;
    font-weight: 500;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--text-dim);
    margin-bottom: 1.2rem;
  }

  header h1 {
    font-family: 'Cormorant Garamond', serif;
    font-weight: 300;
    font-size: clamp(2.4rem, 6vw, 3.8rem);
    line-height: 1.15;
    color: var(--text-primary);
    margin-bottom: 1rem;
  }

  header h1 em { font-style: italic; color: var(--btc-warm); }

  header .subtitle {
    font-size: 0.95rem;
    color: var(--text-secondary);
    max-width: 560px;
    margin: 0 auto;
    line-height: 1.7;
  }

  .insight {
    text-align: center;
    padding: 1.4rem 2rem;
    margin: 1.5rem auto 2.5rem;
    max-width: 640px;
    border-left: 2px solid var(--btc-warm);
    border-right: 2px solid var(--fiat-cold);
    background: linear-gradient(90deg, var(--btc-soft), transparent, var(--fiat-soft));
    border-radius: 2px;
  }

  .insight p {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.1rem;
    font-style: italic;
    color: var(--text-secondary);
    line-height: 1.65;
  }

  /* Dual pies */
  .pies-section {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    gap: 0;
    align-items: start;
    margin-bottom: 2.5rem;
  }

  @media (max-width: 768px) {
    .pies-section {
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }
    .energy-flow { display: none; }
  }

  .pie-panel {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 1.8rem 1.5rem 1.5rem;
    text-align: center;
  }

  .pie-panel.btc { border-top: 2px solid var(--btc-warm); }
  .pie-panel.fiat { border-top: 2px solid var(--fiat-cold); }

  .pie-panel .panel-label {
    font-size: 0.62rem;
    font-weight: 500;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    margin-bottom: 0.35rem;
  }

  .pie-panel.btc .panel-label { color: var(--btc-warm); }
  .pie-panel.fiat .panel-label { color: var(--fiat-cold); }

  .pie-panel h2 {
    font-family: 'Cormorant Garamond', serif;
    font-weight: 400;
    font-size: 1.35rem;
    margin-bottom: 0.25rem;
    color: var(--text-primary);
  }

  .pie-panel .panel-desc {
    font-size: 0.72rem;
    color: var(--text-dim);
    margin-bottom: 1.2rem;
  }

  .pie-visual {
    position: relative;
    width: 100%;
    max-width: 300px;
    margin: 0 auto 1.2rem;
    aspect-ratio: 1;
  }

  .pie-visual canvas { width: 100%; height: 100%; display: block; }

  .pie-label-overlay {
    position: absolute;
    bottom: 8px;
    left: 50%;
    transform: translateX(-50%);
    text-align: center;
    pointer-events: none;
  }

  .pie-label-overlay .pct {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.5rem;
    font-weight: 600;
    display: block;
    line-height: 1.2;
  }

  .pie-panel.btc .pie-label-overlay .pct { color: var(--btc-warm); }
  .pie-panel.fiat .pie-label-overlay .pct { color: var(--fiat-cold); }

  .pie-label-overlay .lbl {
    font-size: 0.65rem;
    color: var(--text-dim);
  }

  .stats-row {
    display: flex;
    justify-content: center;
    gap: 1.4rem;
    flex-wrap: wrap;
    margin-bottom: 0.75rem;
  }

  .stat .val { font-size: 0.95rem; font-weight: 500; display: block; }
  .pie-panel.btc .stat .val { color: var(--btc-warm); }
  .pie-panel.fiat .stat .val { color: var(--fiat-cold); }
  .stat .lbl { font-size: 0.62rem; color: var(--text-dim); letter-spacing: 0.04em; }

  .share-msg {
    margin-top: 0.75rem;
    padding: 0.55rem 1rem;
    border-radius: 6px;
    font-size: 0.76rem;
    line-height: 1.5;
  }

  .pie-panel.btc .share-msg { background: var(--btc-soft); color: var(--btc-warm); }
  .pie-panel.fiat .share-msg { background: var(--fiat-red-soft); color: var(--fiat-red); }
  .pie-panel.fiat .share-msg.neutral { background: var(--fiat-soft); color: var(--fiat-cold); }

  /* Energy flow */
  .energy-flow {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 0 0.6rem;
    min-width: 72px;
    padding-top: 7rem;
  }

  .energy-flow .arrow {
    font-size: 1.5rem;
    color: var(--text-dim);
    transition: all 0.5s;
    opacity: 0.35;
  }

  .energy-flow .arrow.active {
    color: var(--btc-warm);
    opacity: 1;
    text-shadow: 0 0 12px var(--btc-glow);
  }

  .energy-flow .flow-label {
    font-size: 0.55rem;
    color: var(--text-dim);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    text-align: center;
    margin-top: 0.5rem;
    line-height: 1.5;
    max-width: 65px;
  }

  /* Controls */
  .controls {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 2.5rem;
  }

  .controls h3 {
    font-family: 'Cormorant Garamond', serif;
    font-weight: 400;
    font-size: 1.15rem;
    text-align: center;
    margin-bottom: 1.5rem;
    color: var(--text-secondary);
  }

  .slider-row { max-width: 600px; margin: 0 auto; }

  .slider-group { margin-bottom: 1.4rem; }
  .slider-group:last-child { margin-bottom: 0; }

  .slider-group label {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    font-size: 0.8rem;
    color: var(--text-secondary);
    margin-bottom: 0.5rem;
  }

  .slider-group label .slider-val { font-weight: 500; font-size: 0.9rem; color: var(--text-primary); }

  input[type="range"] {
    -webkit-appearance: none;
    width: 100%;
    height: 4px;
    border-radius: 2px;
    outline: none;
    background: var(--border);
    cursor: pointer;
  }

  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    border: 2px solid var(--bg-deep);
    background: var(--btc-warm);
    cursor: pointer;
  }

  .slider-hint {
    font-size: 0.63rem;
    color: var(--text-dim);
    margin-top: 0.3rem;
  }

  .year-markers {
    display: flex;
    justify-content: space-between;
    max-width: 100%;
    margin-top: -0.2rem;
    padding: 0 2px;
  }

  .year-markers span { font-size: 0.58rem; color: var(--text-dim); }

  .btn-row { display: flex; justify-content: center; gap: 1rem; margin-top: 1.5rem; }

  .btn {
    font-family: 'DM Sans', sans-serif;
    font-size: 0.76rem;
    font-weight: 500;
    letter-spacing: 0.05em;
    padding: 0.6rem 1.4rem;
    border-radius: 6px;
    border: 1px solid var(--border);
    background: transparent;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.25s;
  }

  .btn:hover { background: var(--bg-card-hover); color: var(--text-primary); border-color: var(--text-dim); }
  .btn.primary { background: var(--btc-warm); color: var(--bg-deep); border-color: var(--btc-warm); }
  .btn.primary:hover { background: #e8850f; border-color: #e8850f; }

  /* Takeaway */
  .takeaway {
    text-align: center;
    padding: 3rem 2rem;
    border-top: 1px solid var(--border);
  }

  .takeaway h3 {
    font-family: 'Cormorant Garamond', serif;
    font-weight: 300;
    font-size: clamp(1.3rem, 3vw, 1.7rem);
    color: var(--text-primary);
    margin-bottom: 1rem;
    line-height: 1.45;
  }

  .takeaway h3 em { color: var(--btc-warm); font-style: italic; }
  .takeaway h3 .fiat-em { color: var(--fiat-red); font-style: italic; }

  .takeaway p {
    font-size: 0.88rem;
    color: var(--text-secondary);
    max-width: 560px;
    margin: 0 auto;
    line-height: 1.7;
  }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(14px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .fade-up { animation: fadeUp 0.6s ease-out both; }
  .fd1 { animation-delay: 0.1s; }
  .fd2 { animation-delay: 0.2s; }
  .fd3 { animation-delay: 0.35s; }
  .fd4 { animation-delay: 0.5s; }
</style>
</head>
<body>
<div class="container">
  <header class="fade-up">
    <div class="label">Last Coin Standing</div>
    <h1>The <em>Fixed</em> Pie</h1>
    <p class="subtitle">What happens to your slice when the pie can never expand — versus a pie that never stops growing?</p>
  </header>

  <div class="insight fade-up fd1">
    <p>In fiat, the pie expands endlessly — your slice thins to nothing. In Bitcoin, the pie is structurally bounded at 21 million. Your slice is permanent. 1/21M is 1/21M. Forever.</p>
  </div>

  <div class="pies-section fade-up fd2">
    <div class="pie-panel btc">
      <div class="panel-label">Bounded Network</div>
      <h2>Bitcoin</h2>
      <div class="panel-desc">21,000,000 — fixed, thermodynamically sound</div>
      <div class="pie-visual">
        <canvas id="btcPie"></canvas>
        <div class="pie-label-overlay">
          <span class="pct" id="btcPct">—</span>
          <span class="lbl">your slice</span>
        </div>
      </div>
      <div class="stats-row">
        <div class="stat"><span class="val">21,000,000</span><span class="lbl">Total Supply</span></div>
        <div class="stat"><span class="val" id="btcYours">1.0 BTC</span><span class="lbl">Your Slice</span></div>
        <div class="stat"><span class="val" id="btcDensity">—</span><span class="lbl">Energy Density</span></div>
      </div>
      <div class="share-msg" id="btcMsg">Your slice never changes. As monetary energy migrates from fiat, each unit grows denser — more valuable — not thinner.</div>
    </div>

    <div class="energy-flow">
      <span class="arrow" id="flowArrow">◀</span>
      <div class="flow-label" id="flowLabel">monetary energy</div>
    </div>

    <div class="pie-panel fiat">
      <div class="panel-label">Expanding Network</div>
      <h2>Fiat (USD)</h2>
      <div class="panel-desc">Unbounded — expanding ~7% per year</div>
      <div class="pie-visual">
        <canvas id="fiatPie"></canvas>
        <div class="pie-label-overlay">
          <span class="pct" id="fiatPct">—</span>
          <span class="lbl">your slice</span>
        </div>
      </div>
      <div class="stats-row">
        <div class="stat"><span class="val" id="fiatSupply">$21.2T</span><span class="lbl">Money Supply</span></div>
        <div class="stat"><span class="val" id="fiatYours">$100K</span><span class="lbl">Your Slice</span></div>
        <div class="stat"><span class="val" id="fiatDilution">0%</span><span class="lbl">Share Diluted</span></div>
      </div>
      <div class="share-msg neutral" id="fiatMsg">Move the slider to watch the pie expand around your dollars. Same savings. Thinner slice.</div>
    </div>
  </div>

  <div class="controls fade-up fd3">
    <h3>How far out are you looking?</h3>
    <div class="slider-row">
      <div class="slider-group">
        <label>Years of monetary expansion <span class="slider-val" id="yearsVal">0 years</span></label>
        <input type="range" id="yearsSlider" min="0" max="10" value="0" step="1">
        <div class="year-markers"><span>Today</span><span>5 yrs</span><span>10 yrs</span></div>
      </div>
      <div class="slider-group" style="margin-top:1.2rem">
        <label>Your Bitcoin holdings <span class="slider-val" id="btcVal">1.0 BTC</span></label>
        <input type="range" id="btcSlider" min="0.01" max="10" value="1" step="0.01">
        <div class="slider-hint">Drag to see how different positions hold their share</div>
      </div>
      <div class="slider-group" style="margin-top:1.2rem">
        <label>Your fiat savings <span class="slider-val" id="fiatVal">$100,000</span></label>
        <input type="range" id="fiatSlider" min="1000" max="1000000" value="100000" step="1000">
      </div>
    </div>
    <div class="btn-row">
      <button class="btn primary" id="btnPlay">▶ Watch 10 Years</button>
      <button class="btn" id="btnReset">Reset</button>
    </div>
  </div>

  <div class="takeaway fade-up fd4">
    <h3>Fiat expands. Your share <span class="fiat-em">contracts</span>.<br>Bitcoin is fixed. Your share is <em>yours</em>.</h3>
    <p>Every dollar printed silently transfers monetary energy from savers to spenders. Bitcoin's thermodynamic boundary — 21 million, enforced by energy, math, and consensus — means your slice of the network can never be diluted. Only made denser.</p>
  </div>
</div>

<script>
const BTC_TOTAL = 21_000_000;
const FIAT_BASE = 21.2e12;
const ANNUAL_EXPANSION = 0.07;

let state = { years: 0, btcAmount: 1, fiatAmount: 100000, animating: false };

const btcCanvas = document.getElementById('btcPie');
const fiatCanvas = document.getElementById('fiatPie');

function setupCanvas(canvas) {
  const dpr = window.devicePixelRatio || 1;
  const rect = canvas.parentElement.getBoundingClientRect();
  const s = rect.width;
  canvas.width = s * dpr;
  canvas.height = s * dpr;
  canvas.style.width = s + 'px';
  canvas.style.height = s + 'px';
  const ctx = canvas.getContext('2d');
  ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
  return { ctx, s };
}

/* ─── BTC Pie: fixed-radius, your slice glows brighter with energy ─── */
function drawBtc(ctx, s) {
  const cx = s / 2, cy = s / 2, r = s * 0.42;
  const shareRaw = (state.btcAmount / BTC_TOTAL) * Math.PI * 2;
  const vis = Math.max(Math.min(shareRaw * 280000, Math.PI * 0.42), 0.035);
  const density = 1 + state.years * 0.14;

  ctx.clearRect(0, 0, s, s);

  // Whole pie
  ctx.beginPath(); ctx.arc(cx, cy, r, 0, Math.PI * 2); ctx.closePath();
  ctx.fillStyle = '#151620'; ctx.fill();
  ctx.strokeStyle = '#22232e'; ctx.lineWidth = 1.2; ctx.stroke();

  // Radial grid (pizza cuts)
  for (let i = 0; i < 8; i++) {
    const a = (i / 8) * Math.PI * 2;
    ctx.beginPath(); ctx.moveTo(cx, cy);
    ctx.lineTo(cx + Math.cos(a) * r, cy + Math.sin(a) * r);
    ctx.strokeStyle = '#1c1d28'; ctx.lineWidth = 0.6; ctx.stroke();
  }

  // Your slice
  const st = -Math.PI / 2, en = st + vis;

  // Glow
  ctx.save();
  ctx.shadowColor = `rgba(247,147,26,${0.2 + density * 0.07})`;
  ctx.shadowBlur = 12 + density * 10;
  ctx.beginPath(); ctx.moveTo(cx, cy); ctx.arc(cx, cy, r, st, en); ctx.closePath();
  ctx.fillStyle = `rgba(247,147,26,${0.65 + density * 0.04})`;
  ctx.fill();
  ctx.restore();

  // Solid slice with gradient showing energy density
  ctx.beginPath(); ctx.moveTo(cx, cy); ctx.arc(cx, cy, r, st, en); ctx.closePath();
  const g = ctx.createRadialGradient(cx, cy, 0, cx, cy, r);
  g.addColorStop(0, `rgba(247,147,26,${0.95})`);
  g.addColorStop(0.6, `rgba(247,147,26,${0.65 + density * 0.05})`);
  g.addColorStop(1, `rgba(247,147,26,${0.5 + density * 0.08})`);
  ctx.fillStyle = g; ctx.fill();

  // Density rings inside slice (energy accumulation)
  if (state.years > 0) {
    const n = Math.min(state.years, 8);
    for (let i = 1; i <= n; i++) {
      ctx.beginPath();
      ctx.arc(cx, cy, r * (0.15 + i * 0.09), st, en);
      ctx.strokeStyle = `rgba(255,200,100,${0.06 + i * 0.025})`;
      ctx.lineWidth = 1.2; ctx.stroke();
    }
  }

  // Slice edges
  ctx.strokeStyle = 'rgba(247,147,26,0.55)'; ctx.lineWidth = 1.5;
  ctx.beginPath(); ctx.moveTo(cx, cy);
  ctx.lineTo(cx + Math.cos(st) * r, cy + Math.sin(st) * r); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(cx, cy);
  ctx.lineTo(cx + Math.cos(en) * r, cy + Math.sin(en) * r); ctx.stroke();

  // "YOU" label
  const mid = st + vis / 2, lr = r * 0.58;
  ctx.save();
  ctx.font = `600 ${s * 0.03}px "DM Sans",sans-serif`;
  ctx.fillStyle = '#0a0b0f'; ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
  ctx.fillText('YOU', cx + Math.cos(mid) * lr, cy + Math.sin(mid) * lr);
  ctx.restore();

  // Fixed label
  ctx.save();
  ctx.font = `400 ${s * 0.028}px "DM Sans",sans-serif`;
  ctx.fillStyle = '#3a3b46'; ctx.textAlign = 'center';
  ctx.fillText('21M — fixed', cx, cy + r + s * 0.06);
  ctx.restore();
}

/* ─── Fiat Pie: expands outward, your slice gets thinner ─── */
function drawFiat(ctx, s) {
  const cx = s / 2, cy = s / 2;
  const baseR = s * 0.30;
  const expansion = Math.pow(1 + ANNUAL_EXPANSION, state.years);
  const expR = Math.min(baseR * Math.pow(expansion, 0.38), s * 0.46);

  const currentShare = (state.fiatAmount / (FIAT_BASE * expansion)) * Math.PI * 2;
  const vis = Math.max(Math.min(currentShare * 8e8, Math.PI * 0.42), 0.035);

  const baseShare = (state.fiatAmount / FIAT_BASE) * Math.PI * 2;
  const baseVis = Math.max(Math.min(baseShare * 8e8, Math.PI * 0.42), 0.035);

  ctx.clearRect(0, 0, s, s);

  // Ghost: original pie boundary
  if (state.years > 0) {
    ctx.beginPath(); ctx.arc(cx, cy, baseR, 0, Math.PI * 2);
    ctx.setLineDash([3, 4]); ctx.strokeStyle = '#2a2b36'; ctx.lineWidth = 1; ctx.stroke();
    ctx.setLineDash([]);

    ctx.save();
    ctx.font = `300 ${s * 0.024}px "DM Sans",sans-serif`;
    ctx.fillStyle = '#35363f'; ctx.textAlign = 'center';
    ctx.fillText('original pie', cx, cy - baseR - 5);
    ctx.restore();
  }

  // Expanded pie
  ctx.beginPath(); ctx.arc(cx, cy, expR, 0, Math.PI * 2); ctx.closePath();
  ctx.fillStyle = '#13141c'; ctx.fill();
  ctx.strokeStyle = '#22232e'; ctx.lineWidth = 1.2; ctx.stroke();

  // Pizza cuts
  for (let i = 0; i < 8; i++) {
    const a = (i / 8) * Math.PI * 2;
    ctx.beginPath(); ctx.moveTo(cx, cy);
    ctx.lineTo(cx + Math.cos(a) * expR, cy + Math.sin(a) * expR);
    ctx.strokeStyle = '#1a1b24'; ctx.lineWidth = 0.5; ctx.stroke();
  }

  // Expansion rings
  if (state.years > 0) {
    const n = Math.min(state.years, 10);
    for (let i = 1; i <= n; i++) {
      const rr = baseR + (expR - baseR) * (i / n);
      ctx.beginPath(); ctx.arc(cx, cy, rr, 0, Math.PI * 2);
      ctx.strokeStyle = `rgba(90,138,158,${0.04 + i * 0.008})`;
      ctx.lineWidth = 0.7; ctx.stroke();
    }
  }

  // Your slice (thinning)
  const st = -Math.PI / 2, en = st + vis;
  ctx.beginPath(); ctx.moveTo(cx, cy); ctx.arc(cx, cy, expR, st, en); ctx.closePath();
  const g = ctx.createRadialGradient(cx, cy, 0, cx, cy, expR);
  g.addColorStop(0, 'rgba(90,138,158,0.65)');
  g.addColorStop(1, 'rgba(90,138,158,0.35)');
  ctx.fillStyle = g; ctx.fill();

  // Ghost line: where your slice USED to be
  if (state.years > 0) {
    const ghostEn = st + baseVis;
    ctx.beginPath(); ctx.moveTo(cx, cy);
    ctx.lineTo(cx + Math.cos(ghostEn) * expR * 0.55, cy + Math.sin(ghostEn) * expR * 0.55);
    ctx.setLineDash([2, 3]); ctx.strokeStyle = 'rgba(192,57,43,0.35)'; ctx.lineWidth = 1.2; ctx.stroke();
    ctx.setLineDash([]);

    // "was here" micro-label
    const ghMid = (st + ghostEn) / 2, ghR = expR * 0.6;
    ctx.save();
    ctx.font = `300 ${s * 0.02}px "DM Sans",sans-serif`;
    ctx.fillStyle = 'rgba(192,57,43,0.5)'; ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
    const glx = cx + Math.cos(ghostEn + 0.06) * (ghR * 0.7);
    const gly = cy + Math.sin(ghostEn + 0.06) * (ghR * 0.7);
    ctx.fillText('was', glx, gly);
    ctx.restore();
  }

  // Slice edges
  ctx.strokeStyle = 'rgba(90,138,158,0.45)'; ctx.lineWidth = 1.5;
  ctx.beginPath(); ctx.moveTo(cx, cy);
  ctx.lineTo(cx + Math.cos(st) * expR, cy + Math.sin(st) * expR); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(cx, cy);
  ctx.lineTo(cx + Math.cos(en) * expR, cy + Math.sin(en) * expR); ctx.stroke();

  // "YOU"
  const mid = st + vis / 2, lr = expR * 0.48;
  ctx.save();
  ctx.font = `600 ${s * 0.028}px "DM Sans",sans-serif`;
  ctx.fillStyle = '#0a0b0f'; ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
  ctx.fillText('YOU', cx + Math.cos(mid) * lr, cy + Math.sin(mid) * lr);
  ctx.restore();

  // Expanding label
  ctx.save();
  ctx.font = `400 ${s * 0.028}px "DM Sans",sans-serif`;
  ctx.fillStyle = '#3a3b46'; ctx.textAlign = 'center';
  const supplyLabel = state.years > 0 ? fmtMoney(FIAT_BASE * expansion) + ' — expanding' : '$21.2T — expanding';
  ctx.fillText(supplyLabel, cx, cy + expR + s * 0.06);
  ctx.restore();
}

function fmtMoney(n) {
  if (n >= 1e12) return '$' + (n / 1e12).toFixed(1) + 'T';
  if (n >= 1e9) return '$' + (n / 1e9).toFixed(1) + 'B';
  if (n >= 1e6) return '$' + (n / 1e6).toFixed(1) + 'M';
  if (n >= 1e3) return '$' + Math.round(n / 1e3) + 'K';
  return '$' + n;
}

function update() {
  const b = setupCanvas(btcCanvas);
  const f = setupCanvas(fiatCanvas);
  drawBtc(b.ctx, b.s);
  drawFiat(f.ctx, f.s);

  // BTC stats
  const btcShare = (state.btcAmount / BTC_TOTAL) * 100;
  const btcPctStr = btcShare < 0.001 ? btcShare.toExponential(2) + '%' : btcShare.toFixed(btcShare < 0.01 ? 5 : 4) + '%';
  document.getElementById('btcPct').textContent = btcPctStr;
  document.getElementById('btcYours').textContent = state.btcAmount.toFixed(state.btcAmount < 1 ? 2 : state.btcAmount < 10 ? 2 : 1) + ' BTC';
  document.getElementById('btcDensity').textContent = state.years > 0 ? '↑ denser' : 'Baseline';

  // Fiat stats
  const fiatSup = FIAT_BASE * Math.pow(1 + ANNUAL_EXPANSION, state.years);
  const fiatShare = (state.fiatAmount / fiatSup) * 100;
  const fiatPctStr = fiatShare < 0.0001 ? fiatShare.toExponential(2) + '%' : fiatShare.toFixed(fiatShare < 0.001 ? 7 : 5) + '%';
  const initShare = state.fiatAmount / FIAT_BASE;
  const curShare = state.fiatAmount / fiatSup;
  const dilution = state.years > 0 ? ((1 - curShare / initShare) * 100).toFixed(1) : '0';

  document.getElementById('fiatPct').textContent = fiatPctStr;
  document.getElementById('fiatSupply').textContent = fmtMoney(fiatSup);
  document.getElementById('fiatYours').textContent = fmtMoney(state.fiatAmount);
  document.getElementById('fiatDilution').textContent = dilution + '%';

  // Messages
  const btcM = document.getElementById('btcMsg');
  btcM.textContent = state.years > 0
    ? `${state.years} year${state.years > 1 ? 's' : ''} pass. Your slice is still exactly ${btcPctStr}. Unchanged. As monetary energy migrates in from fiat, each sat grows denser — worth more.`
    : 'Your slice never changes. As monetary energy migrates from fiat, each unit grows denser — more valuable — not thinner.';

  const fiatM = document.getElementById('fiatMsg');
  if (state.years > 0) {
    fiatM.textContent = `After ${state.years} year${state.years > 1 ? 's' : ''}: the pie expanded to ${fmtMoney(fiatSup)}. Your ${fmtMoney(state.fiatAmount)} is now ${fiatPctStr} — diluted by ${dilution}%. Same dollars. Thinner slice.`;
    fiatM.classList.remove('neutral');
  } else {
    fiatM.textContent = 'Move the slider to watch the pie expand around your dollars. Same savings. Thinner slice.';
    fiatM.classList.add('neutral');
  }

  // Arrow
  const arrow = document.getElementById('flowArrow');
  const label = document.getElementById('flowLabel');
  if (state.years > 0) {
    arrow.classList.add('active'); arrow.textContent = '◀◀';
    label.textContent = 'energy migrating';
  } else {
    arrow.classList.remove('active'); arrow.textContent = '◀';
    label.textContent = 'monetary energy';
  }
}

// Sliders
document.getElementById('yearsSlider').addEventListener('input', function () {
  state.years = +this.value;
  document.getElementById('yearsVal').textContent = this.value + ' year' + (this.value !== '1' ? 's' : '');
  update();
});
document.getElementById('btcSlider').addEventListener('input', function () {
  state.btcAmount = +this.value;
  document.getElementById('btcVal').textContent = state.btcAmount.toFixed(state.btcAmount < 1 ? 2 : state.btcAmount < 10 ? 2 : 1) + ' BTC';
  update();
});
document.getElementById('fiatSlider').addEventListener('input', function () {
  state.fiatAmount = +this.value;
  document.getElementById('fiatVal').textContent = fmtMoney(state.fiatAmount);
  update();
});

// Animate
document.getElementById('btnPlay').addEventListener('click', function () {
  if (state.animating) return;
  state.animating = true;
  this.textContent = '⏳ Printing...';
  const sl = document.getElementById('yearsSlider');
  let yr = 0;
  const tick = setInterval(() => {
    yr++;
    if (yr <= 10) {
      sl.value = yr; state.years = yr;
      document.getElementById('yearsVal').textContent = yr + ' year' + (yr > 1 ? 's' : '');
      update();
    } else {
      clearInterval(tick); state.animating = false;
      document.getElementById('btnPlay').textContent = '▶ Watch 10 Years';
    }
  }, 450);
});

document.getElementById('btnReset').addEventListener('click', function () {
  state = { years: 0, btcAmount: 1, fiatAmount: 100000, animating: false };
  document.getElementById('yearsSlider').value = 0;
  document.getElementById('btcSlider').value = 1;
  document.getElementById('fiatSlider').value = 100000;
  document.getElementById('yearsVal').textContent = '0 years';
  document.getElementById('btcVal').textContent = '1.0 BTC';
  document.getElementById('fiatVal').textContent = '$100,000';
  update();
});

let rt;
window.addEventListener('resize', () => { clearTimeout(rt); rt = setTimeout(update, 80); });
requestAnimationFrame(update);
</script>
</body>
</html>
